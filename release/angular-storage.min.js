!function(e,t,o){"use strict";t.module("Storage.Service",["Storage.MemoryStorage.Service","Storage.CookieStorage.Service","Storage.SessionStorage.Service","Storage.LocalStorage.Service"]).provider("$storage",function(){this.prefix="",this.enabledStorageEngines=["local","session","cookie","memory"],this.defaultStorageEngine="local",this.setPrefix=function(e){return e&&"."!==e.substr(-1)&&(e+="."),this.prefix=e,this},this.setEnabledStorageEngines=function(e){return t.isArray(e)&&(this.enabledStorageEngines=e),this},this.setDefaultStorageEngine=function(e){return this.defaultStorageEngine=e,this},this.$get=["$parse","$injector","$log",function(e,o,n){function r(e){return"$"+e+"Storage"}function i(e){if(p[e])return p[e];var a=r(e),u=o.get(a);if("memory"!==e&&!u.isSupported()){var c=void 0;t.isFunction(u.getFallbackEngine)&&(c=u.getFallbackEngine()),c=c||"memory",n.warn("Storage engine",e,"not supported in this browser.","Using fallback engine",c,"instead."),u=i(c)}return p[e]=u}function a(e){return e?g+e:""}function u(e){return/^-?\d+\.?\d*$/.test(e.replace(/["']/g,""))}function c(e){return"false"===e||"true"===e}function s(e){return"{"===e.charAt(0)||"["===e.charAt(0)}function l(e){return t.isUndefined(e)||null===e?null:t.isObject(e)||t.isArray(e)||"boolean"==typeof e||t.isNumber(Number(e)||e)?t.toJson(e):e}function f(e){if(!e||null===e||"null"===e)return null;if(s(e)||c(e)||u(e))try{return t.fromJson(e)}catch(e){return null}return e}var g=this.prefix,d=this.enabledStorageEngines,v=this.defaultStorageEngine,p={};if(-1===d.indexOf(v))throw new Error("Default storage engine",v,"is not enabled.");t.forEach(d,function(e){var t=r(e);if(!o.has(t))throw new Error("Storage engine",e,"does not exist.","Make sure the service",t,"is included as a dependency.")});var h=function(e){this.engine=i(e)};h.prototype.set=function(e,t){if(!(e=a(e)))return!1;t=l(t);try{return this.engine.set(e,t),!0}catch(e){return!1}},h.prototype.get=function(e,t){if(void 0===t&&(t=null),!(e=a(e)))return t;try{var o=this.engine.get(e);return null===o?t:f(o)}catch(e){return t}},h.prototype.remove=function(e){if(!(e=a(e)))return!1;try{return this.engine.remove(e),!0}catch(e){return!1}},h.prototype.clear=function(e){e=g+(e||""),this.engine.clear(e)};var b=new h(v),m={};return m[v]=b,t.forEach(d,function(e){Object.defineProperty(b,e,{get:function(){return m[e]?m[e]:m[e]=new h(e)}})}),b}]})}(window,window.angular);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t,o){"use strict";describe("Storage",function(){beforeEach(module("Storage.Service")),beforeEach(module("ngCookies"));var e=void 0;beforeEach(inject(function(t){e=t}));for(var t=["memory","session","local","cookie"],o=0;o<t.length;o++)!function(o){var n=t[o],r=void 0;beforeEach(function(){r=e[n]}),describe("engine "+n,function(){describe("private interface",function(){it("should have a setter",function(){expect(_typeof(r.engine.set)).toBe("function")}),it("should have a getter",function(){expect(_typeof(r.engine.get)).toBe("function")}),it("should have a remover",function(){expect(_typeof(r.engine.remove)).toBe("function")}),it("should have a clearer",function(){expect(_typeof(r.engine.clear)).toBe("function")})}),describe("public interface",function(){it("should have a setter",function(){expect(_typeof(r.set)).toBe("function")}),it("should have a getter",function(){expect(_typeof(r.get)).toBe("function")}),it("should have a remover",function(){expect(_typeof(r.remove)).toBe("function")}),it("should have a clearer",function(){expect(_typeof(r.clear)).toBe("function")})}),describe("storage",function(){var e=void 0;beforeEach(function(){e="test"}),it("should be able to store string values",function(){r.set(e,"test");var t=r.get(e);expect(t).toBe("test"),expect(void 0===t?"undefined":_typeof(t)).toBe(_typeof("test"))}),it("should override values set with the same key",function(){r.set(e,"a"),r.set(e,"b"),r.set(e,"c");var t=r.get(e);expect(t).toBe("c")}),it("should be able to store integer values",function(){for(var t=[1,-1,0],o=0;o<t.length;o++){r.set(e,t[o]);var n=r.get(e);expect(n).toBe(t[o]),expect(void 0===n?"undefined":_typeof(n)).toBe(_typeof(t[o]))}}),it("should be able to store boolean values",function(){for(var t=[!0,!1],o=0;o<t.length;o++){r.set(e,t[o]);var n=r.get(e);expect(n).toBe(t[o]),expect(void 0===n?"undefined":_typeof(n)).toBe(_typeof(t[o]))}}),it("should be able to store float values",function(){for(var t=[1.234,-1.234,0],o=0;o<t.length;o++){r.set(e,t[o]);var n=r.get(e);expect(n).toBe(t[o]),expect(void 0===n?"undefined":_typeof(n)).toBe(_typeof(t[o]))}}),it("should return null for undefined and null values",function(){for(var t=[void 0,null],o=0;o<t.length;o++){r.set(e,t[o]);var n=r.get(e);expect(n).toBeNull()}}),it("should be able to store arrays",function(){var t=["a",1,1.234,null];r.set(e,t);var o=r.get(e);expect(o).toEqual(t);for(var n=0;n<t.length;n++)expect(o).toContain(t[n])}),it("should be able to store nested arrays",function(){var t=["a",1,["b",2,3.456]];r.set(e,t);var o=r.get(e);expect(o).toEqual(t),expect(o[2]).toEqual(t[2]);for(var n=0;n<t[2].length;n++)expect(o[2]).toContain(t[2][n])}),it("should be able to store objects",function(){var t={a:"a",b:1,c:1.234,d:null,e:{f:"b",g:2,h:["c",3,3.456,null]}};r.set(e,t);var o=r.get(e);expect(o).toEqual(t),expect(void 0===o?"undefined":_typeof(o)).toBe(void 0===t?"undefined":_typeof(t))})}),describe("removal",function(){var e=void 0;beforeEach(function(){e="test"}),it("should be able to remove stored values of all types",function(){for(var t=["a",1,1.234,null,{a:"a"},["a",1]],o=0;o<t.length;o++){r.set(e,t[o]),r.remove(e);var n=r.get(e);expect(n).toBeNull()}})}),describe("clearing",function(){it("should clear all set values",function(){var e=["a","b","c"],t=void 0;for(t=0;t<e.length;t++)r.set(e[t],"test");for(r.clear(),t=0;t<e.length;t++){var o=r.get(e[t]);expect(o).toBeNull()}}),it("should clear prefixed values",function(){var e=["pre.a","pre.b","pre.c"],t=void 0;for(t=0;t<e.length;t++)r.set(e[t],"test");for(r.clear("pre."),t=0;t<e.length;t++){var o=r.get(e[t]);expect(o).toBeNull()}}),it("should only clear prefixed values",function(){var e=["pre.a","pre.b","pre.c","a","b","c"],t=void 0;for(t=0;t<e.length;t++)r.set(e[t],"test");for(r.clear("pre."),t=0;t<e.length;t++){var o=r.get(e[t]);1===e[t].length?expect(o).toBe("test"):expect(o).toBeNull()}})})})}(o)})}(window,window.angular),function(e,t,o){"use strict";t.module("Storage.CookieStorage.Service",[]).factory("$cookieStorage",["$injector","$log",function(e,t){var o=void 0;return e.has("$cookies")?o=e.get("$cookies"):t.warn("Cookie storage requires the `ngCookies` module as a dependency"),{isSupported:function(){return!!o},getFallbackEngine:function(){return"memory"},set:function(e,t){o.put(e,t)},get:function(e){return o.get(e)},remove:function(e){o.remove(e)},clear:function(e){for(var t=e?new RegExp("^"+e):null,n=o.getAll(),r=n?Object.keys(n):[],i=0;i<r.length;i++)e&&!t.test(r[i])||o.remove(r[i])}}}])}(window,window.angular),function(e,t,o){"use strict";t.module("Storage.LocalStorage.Service",[]).factory("$localStorage",["$window",function(e){return{isSupported:function(){var t="___"+Math.round(1e7*Math.random());try{return e.localStorage.setItem(t,""),e.localStorage.removeItem(t),!0}catch(e){return!1}},getFallbackEngine:function(){return"cookie"},set:function(t,o){e.localStorage.setItem(t,o)},get:function(t){return e.localStorage.getItem(t)},remove:function(t){e.localStorage.removeItem(t)},clear:function(t){for(var o=t?new RegExp("^"+t):null,n=Object.keys(e.localStorage),r=0;r<n.length;r++)t&&!o.test(n[r])||e.localStorage.removeItem(n[r])}}}])}(window,window.angular),function(e,t,o){"use strict";t.module("Storage.MemoryStorage.Service",[]).factory("$memoryStorage",function(){var e={};return{isSupported:function(){return!0},getFallbackEngine:function(){return""},set:function(t,o){e[t]=o},get:function(t){return void 0===e[t]?null:e[t]},remove:function(t){void 0!==e[t]&&delete e[t]},clear:function(t){for(var o=t?new RegExp("^"+t):null,n=Object.keys(e),r=0;r<n.length;r++)t&&!o.test(n[r])||delete e[n[r]]}}})}(window,window.angular),function(e,t,o){"use strict";t.module("Storage.SessionStorage.Service",[]).factory("$sessionStorage",["$window",function(e){return{isSupported:function(){var t="___"+Math.round(1e7*Math.random());try{return e.sessionStorage.setItem(t,""),e.sessionStorage.removeItem(t),!0}catch(e){return!1}},getFallbackEngine:function(){return"memory"},set:function(t,o){e.sessionStorage.setItem(t,o)},get:function(t){return e.sessionStorage.getItem(t)},remove:function(t){e.sessionStorage.removeItem(t)},clear:function(t){for(var o=t?new RegExp("^"+t):null,n=Object.keys(e.sessionStorage),r=0;r<n.length;r++)t&&!o.test(n[r])||e.sessionStorage.removeItem(n[r])}}}])}(window,window.angular);
//# sourceMappingURL=angular-storage.min.js.map
